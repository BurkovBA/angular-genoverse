!function(){function e(){return function(e){return"Canis familiaris"==e&&(e="Canis lupus familiaris"),e.replace(/ /g,"_").toLowerCase()}}function n(){return function(e){"canis_lupus_familiaris"==e&&(e="canis_familiaris");var n=e.replace(/_/g," ");return n=n.charAt(0).toUpperCase()+n.slice(1)}}function r(){return function(e){return e.toString().match(/^\d+$|^[XYM]$/)?"chr"+e.toString():e.toString()}}function o(e){return{restrict:"E",scope:{genome:"=",chromosome:"=",start:"=",end:"="},template:"<div class='wrap genoverse-wrap'>    <p class='text-muted'>        <span id='genomic-location' class='margin-right-5px'></span>        View in <a href='http://{{domain}}/{{genome.species | urlencodeSpecies}}/Location/View?r={{chromosome}}:{{start}}-{{end}}' id='ensembl-link' target='_blank'>Ensembl</a>        <span ng-show='genome.assembly_ucsc' class='ucsc-link'>|            <a href='http://genome.ucsc.edu/cgi-bin/hgTracks?db={{genome.assembly_ucsc}}&position={{chromosome | chrToUCSC}}%3A{{start}}-{{end}}' target='_blank'>UCSC</a>        </span>    </p><div id='genoverse'></div></div>",link:function(n,r,o){function s(){var o={container:r.find("#genoverse"),width:$(".container").width(),urlParamTemplate:!1,chr:n.chromosome,start:n.start,end:n.end,species:n.genome.species,genome:e("urlencodeSpecies")(n.genome.species),plugins:["controlPanel","karyotype","resizer","fileDrop"],tracks:[Genoverse.Track.Scalebar,Genoverse.Track.extend({name:"Sequence",model:t("ensemblSequence"),view:Genoverse.Track.View.Sequence,controller:Genoverse.Track.Controller.Sequence,resizable:"auto",autoHeight:!0,1e5:!1}),Genoverse.Track.extend({name:"Genes",info:"Ensembl API genes",labels:!0,model:t("ensemblGene"),view:Genoverse.Track.View.Gene.Ensembl,controller:Genoverse.Track.Controller.Ensembl,autoHeight:!0}),Genoverse.Track.extend({name:"Transcripts",info:"Ensembl API transcripts",labels:!0,model:t("ensemblTranscript"),view:Genoverse.Track.View.Transcript.Ensembl,controller:Genoverse.Track.Controller.Ensembl,autoHeight:!0}),Genoverse.Track.extend({name:"RNAcentral",id:"RNAcentral",info:"Unique RNAcentral Sequences",labels:!0,model:t("rnacentral"),view:Genoverse.Track.View.Transcript.Ensembl,controller:Genoverse.Track.Controller.Ensembl,autoHeight:!0,populateMenu:function(e){return{title:'<a target=_blank href="http://rnacentral.org/rna/'+e.label+'">'+e.label+"</a>",id:e.id,biotype:e.biotype,start:e.start,end:e.end,strand:e.strand}}})]};n.domain=_(n.genome),n.browser=new Genoverse(o),n.browser.on({afterInit:function(){n.genoverseToAngularWatches=a(),n.angularToGenoverseWatches=i(),n.$$phase||n.$apply()},afterSetRange:function(){n.$$phase||n.$apply()}})}function a(){var e=n.$watch("browser.species",function(e,r){n.genome=u(e),n.domain=_(n.genome)}),r=n.$watch("browser.chr",function(e,r){n.chromosome=e}),o=n.$watch("browser.start",function(e,r){n.start=e}),s=n.$watch("browser.end",function(e,r){n.end=e});return[e,r,o,s]}function i(){var e=n.$watch("start",function(e,r){angular.equals(e,r)||n.browser.moveTo(n.chromosome,e,n.end,!0)}),r=n.$watch("end",function(e,r){angular.equals(e,r)||n.browser.moveTo(n.chromosome,n.start,e,!0)}),o=n.$watch("chromosome",function(e,r){angular.equals(e,r)||n.browser.moveTo(e,n.start,n.end,!0)}),a=n.$watch("genome",function(e,r){angular.equals(e,r)||(n.genoverseToAngularWatches.forEach(function(e){e()}),n.angularToGenoverseWatches.forEach(function(e){e()}),n.browser.destroy(),delete n.browser,n.chromosome=e.example_location.chromosome,n.start=e.example_location.start,n.end=e.example_location.end,s())});return[a,o,e,r]}function t(r){var o,s,a=c(n.genome.species);return"ensemblGene"===r?(s="__ENDPOINT__/overlap/region/__SPECIES__/__CHR__:__START__-__END__?feature=gene;content-type=application/json".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Gene.Ensembl.extend({url:s})):"ensemblTranscript"===r?(s="__ENDPOINT__/overlap/region/__SPECIES__/__CHR__:__START__-__END__?feature=transcript;feature=exon;feature=cds;content-type=application/json".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Transcript.Ensembl.extend({url:s})):"ensemblSequence"===r?(s="__ENDPOINT__/sequence/region/__SPECIES__/__CHR__:__START__-__END__?content-type=text/plain".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Sequence.Ensembl.extend({url:s})):"rnacentral"===r&&(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.host+"/"),s=window.location.origin+"/api/v1/overlap/region/__SPECIES__/__CHR__:__START__-__END__".replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Gene.Ensembl.extend({url:s,parseData:function(e){for(var n=0;n<e.length;n++){var r=e[n];"transcript"!==r.feature_type||this.featuresById[r.ID]?"exon"===r.feature_type&&this.featuresById[r.Parent]&&(r.id=r.ID,r.chr=r.seq_region_name,this.featuresById[r.Parent].exons[r.id]||(this.featuresById[r.Parent].exons.push(r),this.featuresById[r.Parent].exons[r.id]=r)):(r.id=r.ID,r.label=r.external_name,r.exons=[],r.cds=[],r.chr=r.seq_region_name,this.insertFeature(r))}}})),o}function c(n){var r=["ailuropoda_melanoleuca","anas_platyrhynchos","anolis_carolinensis","astyanax_mexicanus","bos_taurus","callithrix_jacchus","canis_lupus_familiaris","cavia_porcellus","ceratotherium_simum_simum","chlorocebus_sabaeus","choloepus_hoffmanni","chrysemys_picta_bellii","ciona_intestinalis","ciona_savignyi","cricetulus_griseus","danio_rerio","dasypus_novemcinctus","dipodomys_ordii","drosophila_melanogaster","echinops_telfairi","equus_caballus","erinaceus_europaeus","felis_catus","ficedula_albicollis","gadus_morhua","gallus_gallus","gasterosteus_aculeatus","gorilla_gorilla_gorilla","heterocephalus_glaber","homo_sapiens","ictidomys_tridecemlineatus","latimeria_chalumnae","lepisosteus_oculatus","loxodonta_africana","macaca_fascicularis","macaca_mulatta","macropus_eugenii","meleagris_gallopavo","melopsittacus_undulatus","microcebus_murinus","microtus_ochrogaster","monodelphis_domestica","mus_musculus","mustela_putorius_furo","myotis_lucifugus","nomascus_leucogenys","ochotona_princeps","oreochromis_niloticus","ornithorhynchus_anatinus","orycteropus_afer_afer","oryctolagus_cuniculus","oryzias_latipes","otolemur_garnettii","ovis_aries","pan_troglodytes","papio_anubis","papio_hamadryas","pelodiscus_sinensis","petromyzon_marinus","poecilia_formosa","pongo_abelii","procavia_capensis","pteropus_vampyrus","rattus_norvegicus","saimiri_boliviensis","sarcophilus_harrisii","sorex_araneus","sus_scrofa","sus_scrofa_map","taeniopygia_guttata","takifugu_rubripes","tarsius_syrichta","tetraodon_nigroviridis","tupaia_belangeri","tursiops_truncatus","vicugna_pacos","xenopus_tropicalis","xiphophorus_maculatus"],o=e("urlencodeSpecies")(n);return r.indexOf(o)>-1?"https://rest.ensembl.org":"https://rest.ensemblgenomes.org"}function l(){var e=$(".container").width();n.browser.setWidth(e),n.$$phase||n.$apply()}function u(e){e=e.replace(/_/g," ");for(var n=0;n<genomes.length;n++){if(e.toLowerCase()==genomes[n].species.toLowerCase())return genomes[n];var r=[];if(genomes[n].synonyms.forEach(function(e){r.push(e.toLowerCase())}),r.indexOf(e.toLowerCase())>-1)return genomes[n]}return null}function _(e){var n;return"Ensembl"==e.division?n="ensembl.org":"Ensembl Plants"==e.division?n="plants.ensembl.org":"Ensembl Metazoa"==e.division?n="metazoa.ensembl.org":"Ensembl Bacteria"==e.division?n="bacteria.ensembl.org":"Ensembl Fungi"==e.division?n="fungi.ensembl.org":"Ensembl Protists"==e.division&&(n="protists.ensembl.org"),n}s(),$(window).on("resize",l)}}}e.$inject=[],n.$inject=[],r.$inject=[],o.$inject=["$filter"],angular.module("Genoverse",[]).filter("urlencodeSpecies",e).filter("urldecodeSpecies",n).filter("chrToUCSC",r).directive("genoverse",o)}();
//# sourceMappingURL=/dist/angularjs-genoverse.min.js.map