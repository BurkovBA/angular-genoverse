!function(){function e(){return function(e){return"Canis familiaris"==e&&(e="Canis lupus familiaris"),e.replace(/ /g,"_").toLowerCase()}}function r(){return function(e){"canis_lupus_familiaris"==e&&(e="canis_familiaris");var r=e.replace(/_/g," ");return r=r.charAt(0).toUpperCase()+r.slice(1)}}function n(){return function(e){return e.toString().match(/^\d+$|^[XYM]$/)?"chr"+e.toString():e.toString()}}function o(e,r){return{restrict:"E",scope:{genome:"=",chromosome:"=",start:"=",end:"=",tracks:"="},template:"<div class='wrap genoverse-wrap'>    <p class='text-muted'>        <span id='genomic-location' class='margin-right-5px'></span>        View in <a href='http://{{domain}}/{{genome.species | urlencodeSpecies}}/Location/View?r={{chromosome}}:{{start}}-{{end}}' id='ensembl-link' target='_blank'>Ensembl</a>        <span ng-show='genome.assembly_ucsc' class='ucsc-link'>|            <a href='http://genome.ucsc.edu/cgi-bin/hgTracks?db={{genome.assembly_ucsc}}&position={{chromosome | chrToUCSC}}%3A{{start}}-{{end}}' target='_blank'>UCSC</a>        </span>    </p><div id='genoverse'></div><div id='for-tracks'></div></div>",transclude:!0,controller:["$scope","$element","$attrs",function(n,o,t){function a(e){e=e.replace(/_/g," ");for(var r=0;r<genomes.length;r++){if(e.toLowerCase()==genomes[r].species.toLowerCase())return genomes[r];var n=[];if(genomes[r].synonyms.forEach(function(e){n.push(e.toLowerCase())}),n.indexOf(e.toLowerCase())>-1)return genomes[r]}return null}function s(e){var r;return"Ensembl"==e.division?r="ensembl.org":"Ensembl Plants"==e.division?r="plants.ensembl.org":"Ensembl Metazoa"==e.division?r="metazoa.ensembl.org":"Ensembl Bacteria"==e.division?r="bacteria.ensembl.org":"Ensembl Fungi"==e.division?r="fungi.ensembl.org":"Ensembl Protists"==e.division&&(r="protists.ensembl.org"),r}var i=this;i.trackConfigs=[],i.render=function(){var t=[Genoverse.Track.Scalebar];i.trackConfigs.forEach(function(e){t.push(i.parseTrackConfig(e))});var a={container:o.find("#genoverse"),width:$(".container").width(),urlParamTemplate:!1,chr:n.chromosome,start:n.start,end:n.end,species:n.genome.species,genome:e("urlencodeSpecies")(n.genome.species),plugins:["controlPanel","karyotype","resizer","fileDrop"],tracks:t};n.domain=s(n.genome),n.browser=new Genoverse(a),n.browser.on({afterInit:function(){n.genoverseToAngularWatches=i.setGenoverseToAngularWatches(),n.angularToGenoverseWatches=i.setAngularToGenoverseWatches(),r(angular.noop)},afterSetRange:function(){r(angular.noop)}})},i.pushTrackConfig=function(e){i.trackConfigs.push(e)},i.parseTrackConfig=function(e){console.log("parseTrackConfig trackConfig = ",e);var r=angular.element.extend({},e),n={};return n.url="function"==typeof r.url?r.url():r.url,delete r.url,r.modelExtra&&(angular.element.extend(n,e.modelExtra),delete r.modelExtra),r.model=r.model.extend(n),r.viewExtra&&(r.view=r.view.extend(viewExtra),delete r.viewExtra),r.controllerExtra&&(r.controller=r.controller.extend(controllerExtra),delete r.controllerExtra),r.extra&&(angular.element.extend(r,r.extra),delete r.extra),Genoverse.Track.extend(r)},i.setGenoverseToAngularWatches=function(){var e=n.$watch("browser.species",function(e,r){n.genome=a(e),n.domain=s(n.genome)}),r=n.$watch("browser.chr",function(e,r){n.chromosome=e}),o=n.$watch("browser.start",function(e,r){n.start=e}),t=n.$watch("browser.end",function(e,r){n.end=e});return[e,r,o,t]},i.setAngularToGenoverseWatches=function(){var e=n.$watch("start",function(e,r){angular.equals(e,r)||n.browser.moveTo(n.chromosome,e,n.end,!0)}),r=n.$watch("end",function(e,r){angular.equals(e,r)||n.browser.moveTo(n.chromosome,n.start,e,!0)}),o=n.$watch("chromosome",function(e,r){angular.equals(e,r)||n.browser.moveTo(e,n.start,n.end,!0)}),t=n.$watch("genome",function(e,r){angular.equals(e,r)||(n.genoverseToAngularWatches.forEach(function(e){e()}),n.angularToGenoverseWatches.forEach(function(e){e()}),n.browser.destroy(),delete n.browser,n.chromosome=e.example_location.chromosome,n.start=e.example_location.start,n.end=e.example_location.end,i.render())});return[t,o,e,r]},i.setGenoverseWidth=function(){var e=$(".container").width();n.browser.setWidth(e),r(angular.noop)}}],link:function(e,r,n,o,t){t(function(e){r.find("#for-tracks").append(e)}).detach(),o.render(),$(window).on("resize",o.setGenoverseWidth)}}}function t(){return{restrict:"E",require:"^genoverse",template:"",scope:{name:"@",labels:"@?",id:"@?",model:"=",modelExtra:"=?",url:"=",view:"=",viewExtra:"=?",controller:"=",controllerExtra:"=?",resizable:"@?",autoHeight:"@?",extra:"=?"},link:function(e,r,n,o){console.log("genoverseTrack scope = ",e);var t={};t.name=e.name,t.model=e.model,t.view=e.view,t.controller=e.controller,t.url=e.url,e.labels&&(t.labels=e.labels),e.id&&(t.id=e.id),e.resizable&&(t.resizable=e.resizable),e.autoHeight&&(t.autoHeight=e.autoHeight),e.modelExtra&&(t.modelExtra=e.modelExtra),e.viewExtra&&(t.viewExtra=e.viewExtra),e.controllerExtra&&(t.controllerExtra=e.controllerExtra),e.extra&&(t.extra=e.extra),console.log("genoverseTrack trackConfig = ",t),o.pushTrackConfig(t)}}}e.$inject=[],r.$inject=[],n.$inject=[],o.$inject=["$filter","$timeout"],t.$inject=[],angular.module("Genoverse",[]).filter("urlencodeSpecies",e).filter("urldecodeSpecies",r).filter("chrToUCSC",n).directive("genoverse",o).directive("genoverseTrack",t)}();
//# sourceMappingURL=/dist/angularjs-genoverse.min.js.map