!function(){function e(){return function(e){return"Canis familiaris"==e&&(e="Canis lupus familiaris"),e.replace(/ /g,"_").toLowerCase()}}function n(){return function(e){"canis_lupus_familiaris"==e&&(e="canis_familiaris");var n=e.replace(/_/g," ");return n=n.charAt(0).toUpperCase()+n.slice(1)}}function r(){return function(e){return e.toString().match(/^\d+$|^[XYM]$/)?"chr"+e.toString():e.toString()}}function o(e,n){return{restrict:"E",scope:{genome:"=",chromosome:"=",start:"=",end:"="},transclude:!0,template:"<div class='wrap genoverse-wrap'>    <p class='text-muted'>        <span id='genomic-location' class='margin-right-5px'></span>        View in <a href='http://{{domain}}/{{genome.species | urlencodeSpecies}}/Location/View?r={{chromosome}}:{{start}}-{{end}}' id='ensembl-link' target='_blank'>Ensembl</a>        <span ng-show='genome.assembly_ucsc' class='ucsc-link'>|            <a href='http://genome.ucsc.edu/cgi-bin/hgTracks?db={{genome.assembly_ucsc}}&position={{chromosome | chrToUCSC}}%3A{{start}}-{{end}}' target='_blank'>UCSC</a>        </span>    </p><div id='genoverse'></div></div>",controller:function(r,o,s,a){function i(){var s={container:o.find("#genoverse"),width:$(".container").width(),urlParamTemplate:!1,chr:r.chromosome,start:r.start,end:r.end,species:r.genome.species,genome:e("urlencodeSpecies")(r.genome.species),plugins:["controlPanel","karyotype","resizer","fileDrop"],tracks:[Genoverse.Track.Scalebar,Genoverse.Track.extend({name:"Sequence",model:l("ensemblSequence"),view:Genoverse.Track.View.Sequence,controller:Genoverse.Track.Controller.Sequence,resizable:"auto",autoHeight:!0,1e5:!1}),Genoverse.Track.extend({name:"Genes",info:"Ensembl API genes",labels:!0,model:l("ensemblGene"),view:Genoverse.Track.View.Gene.Ensembl,controller:Genoverse.Track.Controller.Ensembl,autoHeight:!0}),Genoverse.Track.extend({name:"Transcripts",info:"Ensembl API transcripts",labels:!0,model:l("ensemblTranscript"),view:Genoverse.Track.View.Transcript.Ensembl,controller:Genoverse.Track.Controller.Ensembl,autoHeight:!0}),Genoverse.Track.extend({name:"RNAcentral",id:"RNAcentral",info:"Unique RNAcentral Sequences",labels:!0,model:l("rnacentral"),view:Genoverse.Track.View.Transcript.Ensembl,controller:Genoverse.Track.Controller.Ensembl,autoHeight:!0,populateMenu:function(e){return{title:'<a target=_blank href="http://rnacentral.org/rna/'+e.label+'">'+e.label+"</a>",id:e.id,biotype:e.biotype,start:e.start,end:e.end,strand:e.strand}}})]};r.domain=p(r.genome),r.browser=new Genoverse(s),r.browser.on({afterInit:function(){r.genoverseToAngularWatches=t(),r.angularToGenoverseWatches=c(),n(angular.noop)},afterSetRange:function(){n(angular.noop)}})}function t(){var e=r.$watch("browser.species",function(e,n){r.genome=m(e),r.domain=p(r.genome)}),n=r.$watch("browser.chr",function(e,n){r.chromosome=e}),o=r.$watch("browser.start",function(e,n){r.start=e}),s=r.$watch("browser.end",function(e,n){r.end=e});return[e,n,o,s]}function c(){var e=r.$watch("start",function(e,n){angular.equals(e,n)||r.browser.moveTo(r.chromosome,e,r.end,!0)}),n=r.$watch("end",function(e,n){angular.equals(e,n)||r.browser.moveTo(r.chromosome,r.start,e,!0)}),o=r.$watch("chromosome",function(e,n){angular.equals(e,n)||r.browser.moveTo(e,r.start,r.end,!0)}),s=r.$watch("genome",function(e,n){angular.equals(e,n)||(r.genoverseToAngularWatches.forEach(function(e){e()}),r.angularToGenoverseWatches.forEach(function(e){e()}),r.browser.destroy(),delete r.browser,r.chromosome=e.example_location.chromosome,r.start=e.example_location.start,r.end=e.example_location.end,i())});return[s,o,e,n]}function l(n){var o,s,a=u(r.genome.species);return"ensemblGene"===n?(s="__ENDPOINT__/overlap/region/__SPECIES__/__CHR__:__START__-__END__?feature=gene;content-type=application/json".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(r.genome.species)),o=Genoverse.Track.Model.Gene.Ensembl.extend({url:s})):"ensemblTranscript"===n?(s="__ENDPOINT__/overlap/region/__SPECIES__/__CHR__:__START__-__END__?feature=transcript;feature=exon;feature=cds;content-type=application/json".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(r.genome.species)),o=Genoverse.Track.Model.Transcript.Ensembl.extend({url:s})):"ensemblSequence"===n?(s="__ENDPOINT__/sequence/region/__SPECIES__/__CHR__:__START__-__END__?content-type=text/plain".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(r.genome.species)),o=Genoverse.Track.Model.Sequence.Ensembl.extend({url:s})):"rnacentral"===n&&(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.host+"/"),s=window.location.origin+"/api/v1/overlap/region/__SPECIES__/__CHR__:__START__-__END__".replace("__SPECIES__",e("urlencodeSpecies")(r.genome.species)),o=Genoverse.Track.Model.Gene.Ensembl.extend({url:s,parseData:function(e){for(var n=0;n<e.length;n++){var r=e[n];"transcript"!==r.feature_type||this.featuresById[r.ID]?"exon"===r.feature_type&&this.featuresById[r.Parent]&&(r.id=r.ID,r.chr=r.seq_region_name,this.featuresById[r.Parent].exons[r.id]||(this.featuresById[r.Parent].exons.push(r),this.featuresById[r.Parent].exons[r.id]=r)):(r.id=r.ID,r.label=r.external_name,r.exons=[],r.cds=[],r.chr=r.seq_region_name,this.insertFeature(r))}}})),o}function u(n){var r=["ailuropoda_melanoleuca","anas_platyrhynchos","anolis_carolinensis","astyanax_mexicanus","bos_taurus","callithrix_jacchus","canis_lupus_familiaris","cavia_porcellus","ceratotherium_simum_simum","chlorocebus_sabaeus","choloepus_hoffmanni","chrysemys_picta_bellii","ciona_intestinalis","ciona_savignyi","cricetulus_griseus","danio_rerio","dasypus_novemcinctus","dipodomys_ordii","drosophila_melanogaster","echinops_telfairi","equus_caballus","erinaceus_europaeus","felis_catus","ficedula_albicollis","gadus_morhua","gallus_gallus","gasterosteus_aculeatus","gorilla_gorilla_gorilla","heterocephalus_glaber","homo_sapiens","ictidomys_tridecemlineatus","latimeria_chalumnae","lepisosteus_oculatus","loxodonta_africana","macaca_fascicularis","macaca_mulatta","macropus_eugenii","meleagris_gallopavo","melopsittacus_undulatus","microcebus_murinus","microtus_ochrogaster","monodelphis_domestica","mus_musculus","mustela_putorius_furo","myotis_lucifugus","nomascus_leucogenys","ochotona_princeps","oreochromis_niloticus","ornithorhynchus_anatinus","orycteropus_afer_afer","oryctolagus_cuniculus","oryzias_latipes","otolemur_garnettii","ovis_aries","pan_troglodytes","papio_anubis","papio_hamadryas","pelodiscus_sinensis","petromyzon_marinus","poecilia_formosa","pongo_abelii","procavia_capensis","pteropus_vampyrus","rattus_norvegicus","saimiri_boliviensis","sarcophilus_harrisii","sorex_araneus","sus_scrofa","sus_scrofa_map","taeniopygia_guttata","takifugu_rubripes","tarsius_syrichta","tetraodon_nigroviridis","tupaia_belangeri","tursiops_truncatus","vicugna_pacos","xenopus_tropicalis","xiphophorus_maculatus"],o=e("urlencodeSpecies")(n);return r.indexOf(o)>-1?"https://rest.ensembl.org":"https://rest.ensemblgenomes.org"}function _(){var e=$(".container").width();r.browser.setWidth(e),n(angular.noop)}function m(e){e=e.replace(/_/g," ");for(var n=0;n<genomes.length;n++){if(e.toLowerCase()==genomes[n].species.toLowerCase())return genomes[n];var r=[];if(genomes[n].synonyms.forEach(function(e){r.push(e.toLowerCase())}),r.indexOf(e.toLowerCase())>-1)return genomes[n]}return null}function p(e){var n;return"Ensembl"==e.division?n="ensembl.org":"Ensembl Plants"==e.division?n="plants.ensembl.org":"Ensembl Metazoa"==e.division?n="metazoa.ensembl.org":"Ensembl Bacteria"==e.division?n="bacteria.ensembl.org":"Ensembl Fungi"==e.division?n="fungi.ensembl.org":"Ensembl Protists"==e.division&&(n="protists.ensembl.org"),n}i(),$(window).on("resize",_)}}}e.$inject=[],n.$inject=[],r.$inject=[],o.$inject=["$filter","$timeout"],angular.module("Genoverse",[]).filter("urlencodeSpecies",e).filter("urldecodeSpecies",n).filter("chrToUCSC",r).directive("genoverse",o)}();
//# sourceMappingURL=/dist/angularjs-genoverse.min.js.map